# Schema documentation

Generated by MySQL Workbench Model Documentation v1.0.0

-------------------------------------------------

## Table: `users`

### Description:

Users table

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | INT | PRIMARY, Auto increments, Not null |   |   |
| `firstname` | VARCHAR(255) |  | `NULL` |   |
| `lastname` | VARCHAR(255) |  | `NULL` |   |
| `name` | VARCHAR(255) |  | `NULL` |   |
| `email` | VARCHAR(255) | Not null, Unique |   |   |
| `password` | VARCHAR(255) | Not null |   |   |
| `phone_number` | VARCHAR(255) |  | `NULL` |   |
| `sex` | TINYINT |  | `NULL` |   |
| `remember_token` | VARCHAR(100) |  | `NULL` |   |
| `created_at` | TIMESTAMP |  | `NULL` |   |
| `updated_at` | TIMESTAMP |  | `NULL` |   |
| `group_id` | INT |  | `NULL` |  **foreign key** to column `id` on table `groups`. |
| `status` | VARCHAR(255) |  | `NULL` |   |
| `accesstoken` | VARCHAR(255) | Not null, Unique |   |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |
| users_email_unique | `email` | UNIQUE |   |
| users_accesstoken_unique | `accesstoken` | UNIQUE |   |
| users_group_id_foreign | `group_id` | INDEX |   |

-------------------------------------------------

## Table: `car_types`

### Description:

Car types

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | INT | PRIMARY, Auto increments, Not null |   |   |
| `name` | VARCHAR(255) | Not null, Unique |   |   |
| `description` | VARCHAR(255) |  | `NULL` |   |
| `nb_place` | INT | Not null | `'1'` | A car type already carries info on nb_place so that cars can directly inherit from that |
| `created_at` | TIMESTAMP |  | `NULL` |   |
| `updated_at` | TIMESTAMP |  | `NULL` |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |
| car_types_name_unique | `name` | UNIQUE |   |

-------------------------------------------------

## Table: `cars`

### Description:

Car info

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | INT | PRIMARY, Auto increments, Not null |   |   |
| `created_at` | TIMESTAMP |  | `NULL` |   |
| `updated_at` | TIMESTAMP |  | `NULL` |   |
| `plate_number` | VARCHAR(255) |  | `NULL` |   |
| `brand` | VARCHAR(255) |  | `NULL` |   |
| `model` | VARCHAR(255) |  | `NULL` |   |
| `color` | VARCHAR(255) |  | `NULL` |   |
| `nb_place` | INT |  | `NULL` |   |
| `name` | VARCHAR(255) | Not null |   |   |
| `deleted_at` | TIMESTAMP |  | `NULL` |   |
| `car_type_id` | INT | Not null |   |  **foreign key** to column `id` on table `car_types`. |
| `status` | VARCHAR(255) |  | `NULL` |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |
| cars_car_type_id_foreign | `car_type_id` | INDEX |   |

-------------------------------------------------

### Table: `comments`

#### Description:

Comments made by users on certain models.
Implements laravel polymorphic relationships.

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | INT | PRIMARY, Auto increments, Not null |   |   |
| `content` | TEXT | Not null |   |   |
| `user_id` | INT | Not null |   | user id who made the comment<br /><br />**foreign key** to column `id` on table `users`. |
| `commentable_id` | INT | Not null |   |   |
| `commentable_type` | VARCHAR(255) | Not null |   |   |
| `created_at` | TIMESTAMP |  | `NULL` |   |
| `updated_at` | TIMESTAMP |  | `NULL` |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |
| comments_user_id_foreign | `user_id` | INDEX |   |
| comments_commentable_id_commentable_type_index | `commentable_id`, `commentable_type` | INDEX |   |

-------------------------------------------------

## Table: `groups`

### Description:

Defines user groups

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | INT | PRIMARY, Auto increments, Not null |   |   |
| `color` | VARCHAR(255) | Not null |   |   |
| `name` | VARCHAR(255) |  | `NULL` |   |
| `active` | TINYINT |  | `NULL` | DEPRECEATED |
| `created_at` | TIMESTAMP |  | `NULL` |   |
| `updated_at` | TIMESTAMP |  | `NULL` |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |

-------------------------------------------------

## Table: `images`

### Description:

Uploaded images to the server.
Right now only contains license and profile image.

This is specified in the `type` field.

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | INT | PRIMARY, Auto increments, Not null |   |   |
| `created_at` | TIMESTAMP |  | `NULL` |   |
| `updated_at` | TIMESTAMP |  | `NULL` |   |
| `filename` | VARCHAR(255) | Not null |   | filepath on which the image needs to recovered. e.g images/profile/myImage.png |
| `type` | VARCHAR(255) | Not null |   | Defines which type of image is used. as of now, license or profile |
| `user_id` | INT | Not null |   |  **foreign key** to column `id` on table `users`. |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |
| images_user_id_foreign | `user_id` | INDEX |   |

-------------------------------------------------

## Table: `runs`

### Description:

Defines a run

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | INT | PRIMARY, Auto increments, Not null |   |   |
| `drafting` | TINYINT | Not null | `'1'` | Hard coded value of status=drafting, allowing the Object model to be easier to understand and manipulate |
| `started_at` | DATETIME |  | `NULL` | Defines the date at which a run started |
| `published_at` | DATETIME |  | `NULL` | Used for stats only, to get time between publishing |
| `ended_at` | DATETIME |  | `NULL` |   |
| `planned_at` | DATETIME |  | `NULL` |   |
| `nb_passenger` | INT | Not null | `'0'` |   |
| `name` | VARCHAR(255) | Not null |   |   |
| `note` | VARCHAR(255) |  | `NULL` |   |
| `created_at` | TIMESTAMP |  | `NULL` |   |
| `updated_at` | TIMESTAMP |  | `NULL` |   |
| `deleted_at` | TIMESTAMP |  | `NULL` |   |
| `status` | VARCHAR(255) |  | `NULL` |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |

-------------------------------------------------

## Table: `run_drivers`

### Description:

Associates a driver, a car, a car type to a run.

This table is used to define "convoys".

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | INT | PRIMARY, Auto increments, Not null |   |   |
| `car_id` | INT |  | `NULL` |  **foreign key** to column `id` on table `cars`. |
| `user_id` | INT |  | `NULL` |  **foreign key** to column `id` on table `users`. |
| `run_id` | INT | Not null |   |  **foreign key** to column `id` on table `runs`. |
| `car_type_id` | INT |  | `NULL` |  **foreign key** to column `id` on table `car_types`. |
| `created_at` | TIMESTAMP |  | `NULL` |   |
| `updated_at` | TIMESTAMP |  | `NULL` |   |
| `deleted_at` | TIMESTAMP |  | `NULL` |   |
| `status` | VARCHAR(255) |  | `NULL` |   |
| `started_at` | DATETIME |  | `NULL` |   |
| `ended_at` | DATETIME |  | `NULL` |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |
| run_drivers_car_id_foreign | `car_id` | INDEX |   |
| run_drivers_user_id_foreign | `user_id` | INDEX |   |
| run_drivers_run_id_foreign | `run_id` | INDEX |   |
| run_drivers_car_type_id_foreign | `car_type_id` | INDEX |   |

-------------------------------------------------

## Table: `run_waypoint`

### Description:

Defines places the run will go by.

Order column defines the order in which the run will pass

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `waypoint_id` | INT | Not null |   |  **foreign key** to column `id` on table `waypoints`. |
| `run_id` | INT | Not null |   |  **foreign key** to column `id` on table `runs`. |
| `order` | INT | Not null |   | Used to define the order of a waypoint in a run |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| run_waypoint_waypoint_id_foreign | `waypoint_id` | INDEX |   |
| run_waypoint_run_id_foreign | `run_id` | INDEX |   |

-------------------------------------------------

## Table: `schedule_groups`

### Description:

Defines schedules for groups

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | INT | PRIMARY, Auto increments, Not null |   |   |
| `group_id` | INT | Not null |   |  **foreign key** to column `id` on table `groups`. |
| `start_time` | DATETIME | Not null |   |   |
| `end_time` | DATETIME | Not null |   |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |
| schedule_groups_group_id_foreign | `group_id` | INDEX |   |

-------------------------------------------------

## Table: `settings`

### Description:

Define global settings. Accessible though the api.

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | INT | PRIMARY, Auto increments, Not null |   |   |
| `key` | VARCHAR(255) | Not null, Unique |   | Key used to identify a setting |
| `value` | VARCHAR(2048) | Not null |   |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |
| settings_key_unique | `key` | UNIQUE |   |

-------------------------------------------------

## Table: `waypoints`

### Description:

Points in which runs pass by.

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | INT | PRIMARY, Auto increments, Not null |   |   |
| `geo` | LONGTEXT |  | `NULL` | Google geocoder result. |
| `latlng` | LONGTEXT |  | `NULL` | latitude and longitude of waypoint. Stored as json {lat:....,lng:...} |
| `name` | VARCHAR(255) | Not null |   | nickname for the waypoint. Defined by the user |
| `created_at` | TIMESTAMP |  | `NULL` |   |
| `updated_at` | TIMESTAMP |  | `NULL` |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |

-------------------------------------------------

# Vendor tables

## Table: `roles`

### Description:

spatie/laravel-permission.

__YOU SHOULD NEVER POPULATE MANUALLY__

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | INT | PRIMARY, Auto increments, Not null |   |   |
| `name` | VARCHAR(255) | Not null |   |   |
| `guard_name` | VARCHAR(255) | Not null |   |   |
| `created_at` | TIMESTAMP |  | `NULL` |   |
| `updated_at` | TIMESTAMP |  | `NULL` |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |



## Table: `role_has_permissions`

### Description:

spatie/laravel-permission.

__YOU SHOULD NEVER POPULATE MANUALLY__

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `permission_id` | INT | PRIMARY, Not null |   |  **foreign key** to column `id` on table `permissions`. |
| `role_id` | INT | PRIMARY, Not null |   |  **foreign key** to column `id` on table `roles`. |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `permission_id`, `role_id` | PRIMARY |   |
| role_has_permissions_role_id_foreign | `role_id` | INDEX |   |


## Table: `permissions`

### Description:

spatie/laravel-permission.

__YOU SHOULD NEVER POPULATE MANUALLY__

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | INT | PRIMARY, Auto increments, Not null |   |   |
| `name` | VARCHAR(255) | Not null |   |   |
| `guard_name` | VARCHAR(255) | Not null |   |   |
| `created_at` | TIMESTAMP |  | `NULL` |   |
| `updated_at` | TIMESTAMP |  | `NULL` |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |



## Table: `model_has_permissions`

### Description:

spatie/laravel-permission.

__YOU SHOULD NEVER POPULATE MANUALLY__

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `permission_id` | INT | PRIMARY, Not null |   |  **foreign key** to column `id` on table `permissions`. |
| `model_id` | INT | PRIMARY, Not null |   |   |
| `model_type` | VARCHAR(255) | PRIMARY, Not null |   |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `permission_id`, `model_id`, `model_type` | PRIMARY |   |
| model_has_permissions_model_id_model_type_index | `model_id`, `model_type` | INDEX |   |



## Table: `model_has_roles`

### Description:

spatie/laravel-permission.

__YOU SHOULD NEVER POPULATE MANUALLY__

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `role_id` | INT | PRIMARY, Not null |   |  **foreign key** to column `id` on table `roles`. |
| `model_id` | INT | PRIMARY, Not null |   |   |
| `model_type` | VARCHAR(255) | PRIMARY, Not null |   |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `role_id`, `model_id`, `model_type` | PRIMARY |   |
| model_has_roles_model_id_model_type_index | `model_id`, `model_type` | INDEX |   |


-------------------------------------------------

# Laravel internal tables

## Table: `failed_jobs`

### Description:

Laravel vendor table

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | BIGINT | PRIMARY, Auto increments, Not null |   |   |
| `connection` | TEXT | Not null |   |   |
| `queue` | TEXT | Not null |   |   |
| `payload` | LONGTEXT | Not null |   |   |
| `exception` | LONGTEXT | Not null |   |   |
| `failed_at` | TIMESTAMP | Not null | `CURRENT_TIMESTAMP` |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |



## Table: `jobs`

### Description:

Laravel vendor table

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | BIGINT | PRIMARY, Auto increments, Not null |   |   |
| `queue` | VARCHAR(255) | Not null |   |   |
| `payload` | LONGTEXT | Not null |   |   |
| `attempts` | TINYINT | Not null |   |   |
| `reserved_at` | INT |  | `NULL` |   |
| `available_at` | INT | Not null |   |   |
| `created_at` | INT | Not null |   |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |
| jobs_queue_reserved_at_index | `queue`, `reserved_at` | INDEX |   |


## Table: `migrations`

### Description:

Laravel vendor table

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `id` | INT | PRIMARY, Auto increments, Not null |   |   |
| `migration` | VARCHAR(255) | Not null |   |   |
| `batch` | INT | Not null |   |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| PRIMARY | `id` | PRIMARY |   |


## Table: `password_resets`

### Description:

Laravel vendor tables

### Columns:

| Column | Data type | Attributes | Default | Description |
| --- | --- | --- | --- | ---  |
| `email` | VARCHAR(255) | Not null |   |   |
| `token` | VARCHAR(255) | Not null |   |   |
| `created_at` | TIMESTAMP |  | `NULL` |   |


### Indices:

| Name | Columns | Type | Description |
| --- | --- | --- | --- |
| password_resets_email_index | `email` | INDEX |   |
| password_resets_token_index | `token` | INDEX |   |
